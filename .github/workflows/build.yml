name: Build

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup
      run: |
        # Install basic tools
        sudo apt-get update
        sudo apt-get install -y cmake ninja-build g++ git
        
        # Get Geode
        git clone https://github.com/geode-sdk/geode.git geode-sdk --depth=1
        cd geode-sdk
        
        # The Geode SDK is actually a CMake project, not a Python package
        # The correct way is to use it as a CMake subdirectory
        
    - name: Build with CMake
      run: |
        # Create symbolic link to geode-sdk in your project root
        ln -s $(pwd)/geode-sdk geode
        
        mkdir -p build && cd build
        cmake .. -DCMAKE_BUILD_TYPE=Release
        make -j4
        
    - uses: actions/upload-artifact@v4
      with:
        name: mod-build
        path: build/*.geode
